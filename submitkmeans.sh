#!/bin/bash

rm -rf $(pwd)/output; SGX_USE_SHMEM=true SGXLKL_SHMEM_FILE=sgx-lkl-shmem-driver SGXLKL_SHMEM_SIZE=10240000 SGX_ENABLED=true IS_DRIVER=true PREFETCH=8 CONNECTIONS=1 SPARK_LOCAL_IP=127.0.0.1 ./bin/spark-submit --class org.apache.spark.examples.mllib.KMeansExample --master spark://kiwi01.doc.res.ic.ac.uk:7077 --deploy-mode client --verbose --executor-memory 1g --name kmeans --conf "spark.app.id=kmeans" --conf "spark.executor.extraLibraryPath=$(pwd)/lib" --conf "spark.driver.extraLibraryPath=$(pwd)/lib" --conf "spark.driver.extraJavaOptions=-cp $(pwd)/assembly/target/scala-2.11/jars/*:$(pwd)/examples/target/scala-2.11/jars/* -Dlog4j.configuration=file:$(pwd)/conf/log4j.properties" examples/target/scala-2.11/jars/spark-examples_2.11-2.3.1-SNAPSHOT.jar $(pwd)/data/mllib/kmeans_data.txt $(pwd)/output 2>&1 | tee outside-driver
